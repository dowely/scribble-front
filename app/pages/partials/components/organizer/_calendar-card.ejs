<%

let months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']

let weekdays = ['Monday', 'Tuesday', 'Wednsday', 'Thursday', 'Friday', 'Saturday', 'Sunday']

let items = {
  2: ['task', 'note'],
  5: ['event', 'note'],
  9: ['task'],
  10: ['note'],
  15: ['task', 'event', 'note'],
  23: ['task', 'event'],
  25: ['task', 'event', 'meeting', 'note'],
  28: ['task', 'meeting', 'note']
}

let dates = [[], [], [], [], [], [], []] <!-- 7 weekdays -->

let offset = new Date(year, month, 1).getDay() - 1

dates.forEach((weekdayArr, day) => {

  for(let i = 0; i < 6; i++) {

    let myDate = new Date(year, month, 1 - offset + day + i * 7)

    myDate.str = myDate.getDate()
    myDate.currentMonth = myDate.getMonth() === month
    myDate.items = items[myDate.str] || []

    weekdayArr.push(myDate)
  }

})

%>

<div class="calendar-card">

  <div class="calendar-card__nav-bar">

    <div class="calendar-card__title">

      <span class="calendar-card__month">
        <%= months[month] %>
      </span>

      <span class="calendar-card__year">
        <%= year %>
      </span>

    </div>

    <div class="calendar-card__nav-buttons">

    </div>

  </div>

  <div class="calendar-card__main">

    <% dates.forEach((weekdayArr, day) => { %>

      <div class="calendar-card__weekday-col calendar-card__weekday-col--<%= weekdays[day] %>">

        <h4 class="calendar-card__weekday"><%= weekdays[day].substring(0, 3) %></h4>
  
        <div class="calendar-card__dates">
  
          <% weekdayArr.forEach(date => { %>
  
          <div class="calendar-card__date-container<%= date.currentMonth ? ' calendar-card__date-container--current' : '' %><%= date.getTime() === new Date(today).getTime() ? ' calendar-card__date-container--today' : '' %>" data-id="<%= `${date.str} ${months[month].substring(0, 3)} ${year}` %>">
  
            <h6 class="calendar-card__date"><%= date.str %></h6>

            <% if(date.currentMonth) date.items.forEach(item => { %>

            <span class="calendar-card__item-dot calendar-card__item-dot--<%= item %>">.</span>

            <% }) %>
      
          </div>
  
          <% }) %>
  
        </div>
  
      </div>

    <% }) %>

  </div>

</div>